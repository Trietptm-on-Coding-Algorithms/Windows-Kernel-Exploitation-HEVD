# Windows Kernel Exploit development practice - HEVD
# Windows 7 x86 exploits

My implementation of exploits for the [HackSysExtremeVulnerableDriver](https://github.com/hacksysteam/HackSysExtremeVulnerableDriver) project.

#### Exploits : 

1. **Stack Overflow** - privilege escalation

This privilege escalation exploit takes advantage of a stack-based vulnerability within the HEVD program. We can use the CreateFileA() function to establish the HEVD driver device which we can then use the DeviceIoControl() function to pass data to the IOCTL we found with IDA (located at 0x222003). Since we need to communicate with the HEVD driver (in kernel-land) from user-land.

To escalate our privileges we can use the supplied token stealing shellcode which steals the NT Authority / System token and we will have it spawn a new CMD process with elevated privileges.

![image of successful exploitation](https://raw.githubusercontent.com/x00pwn/Windows-Kernel-Exploitation-HEVD/master/images/HEVD_stack-overflow.png)

----

2. **Arbitrary Memory Overwrite (Write-What-Where)** - privilege escalation

This privilege escalation exploit takes advantage of a "Write-What-Where" vulnerability in the HEVD program. 
